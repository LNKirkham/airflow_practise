[2022-03-19 06:01:37,818] {processor.py:163} INFO - Started process (PID=51724) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 06:01:37,819] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 06:01:37,819] {logging_mixin.py:109} INFO - [2022-03-19 06:01:37,819] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 06:01:43,509] {logging_mixin.py:109} INFO - [2022-03-19 06:01:43,502] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 06:01:43,532] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 06:01:43,537] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 5.716 seconds
[2022-03-19 20:56:34,972] {processor.py:163} INFO - Started process (PID=51905) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 20:56:34,974] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 20:56:34,974] {logging_mixin.py:109} INFO - [2022-03-19 20:56:34,974] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 20:56:40,781] {logging_mixin.py:109} INFO - [2022-03-19 20:56:40,774] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 20:56:40,804] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 20:56:40,808] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 5.837 seconds
[2022-03-19 20:58:14,014] {processor.py:163} INFO - Started process (PID=52025) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 20:58:14,015] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 20:58:14,015] {logging_mixin.py:109} INFO - [2022-03-19 20:58:14,015] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 20:58:18,396] {logging_mixin.py:109} INFO - [2022-03-19 20:58:18,394] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 20:58:18,421] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 20:58:18,425] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.412 seconds
[2022-03-19 20:59:37,710] {processor.py:163} INFO - Started process (PID=52086) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 20:59:37,711] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 20:59:37,711] {logging_mixin.py:109} INFO - [2022-03-19 20:59:37,711] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 20:59:41,402] {logging_mixin.py:109} INFO - [2022-03-19 20:59:41,400] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 20:59:41,425] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 20:59:41,432] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.722 seconds
[2022-03-19 21:00:58,180] {processor.py:163} INFO - Started process (PID=52147) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:00:58,180] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:00:58,181] {logging_mixin.py:109} INFO - [2022-03-19 21:00:58,181] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:01:01,795] {logging_mixin.py:109} INFO - [2022-03-19 21:01:01,793] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:01:01,817] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:01:01,821] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.642 seconds
[2022-03-19 21:02:18,309] {processor.py:163} INFO - Started process (PID=52207) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:02:18,310] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:02:18,310] {logging_mixin.py:109} INFO - [2022-03-19 21:02:18,310] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:02:22,196] {logging_mixin.py:109} INFO - [2022-03-19 21:02:22,193] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:02:22,234] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:02:22,247] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.938 seconds
[2022-03-19 21:03:39,138] {processor.py:163} INFO - Started process (PID=52275) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:03:39,138] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:03:39,138] {logging_mixin.py:109} INFO - [2022-03-19 21:03:39,138] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:03:42,955] {logging_mixin.py:109} INFO - [2022-03-19 21:03:42,953] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:03:42,975] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:03:42,980] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.843 seconds
[2022-03-19 21:04:59,570] {processor.py:163} INFO - Started process (PID=52343) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:04:59,570] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:04:59,571] {logging_mixin.py:109} INFO - [2022-03-19 21:04:59,570] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:05:03,710] {logging_mixin.py:109} INFO - [2022-03-19 21:05:03,707] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:05:03,733] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:05:03,738] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.169 seconds
[2022-03-19 21:06:33,558] {processor.py:163} INFO - Started process (PID=52410) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:06:33,558] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:06:33,558] {logging_mixin.py:109} INFO - [2022-03-19 21:06:33,558] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:06:37,537] {logging_mixin.py:109} INFO - [2022-03-19 21:06:37,535] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:06:37,561] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:06:37,566] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.009 seconds
[2022-03-19 21:07:59,287] {processor.py:163} INFO - Started process (PID=52470) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:07:59,287] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:07:59,288] {logging_mixin.py:109} INFO - [2022-03-19 21:07:59,288] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:08:05,975] {logging_mixin.py:109} INFO - [2022-03-19 21:08:05,973] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:08:06,000] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:08:06,006] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 6.720 seconds
[2022-03-19 21:09:28,251] {processor.py:163} INFO - Started process (PID=52538) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:09:28,251] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:09:28,252] {logging_mixin.py:109} INFO - [2022-03-19 21:09:28,251] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:09:31,846] {logging_mixin.py:109} INFO - [2022-03-19 21:09:31,844] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:09:31,871] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:09:31,877] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.627 seconds
[2022-03-19 21:10:50,324] {processor.py:163} INFO - Started process (PID=52615) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:10:50,325] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:10:50,326] {logging_mixin.py:109} INFO - [2022-03-19 21:10:50,326] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:10:54,909] {logging_mixin.py:109} INFO - [2022-03-19 21:10:54,907] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:10:54,933] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:10:54,938] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.614 seconds
[2022-03-19 21:12:20,595] {processor.py:163} INFO - Started process (PID=52792) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:12:20,596] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:12:20,596] {logging_mixin.py:109} INFO - [2022-03-19 21:12:20,596] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:12:26,414] {logging_mixin.py:109} INFO - [2022-03-19 21:12:26,407] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:12:26,442] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:12:26,446] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 5.852 seconds
[2022-03-19 21:13:52,072] {processor.py:163} INFO - Started process (PID=52898) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:13:52,073] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:13:52,073] {logging_mixin.py:109} INFO - [2022-03-19 21:13:52,073] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:13:58,322] {logging_mixin.py:109} INFO - [2022-03-19 21:13:58,314] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:13:58,348] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:13:58,354] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 6.283 seconds
[2022-03-19 21:15:25,655] {processor.py:163} INFO - Started process (PID=52996) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:15:25,658] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:15:25,658] {logging_mixin.py:109} INFO - [2022-03-19 21:15:25,658] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:15:31,147] {logging_mixin.py:109} INFO - [2022-03-19 21:15:31,142] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:15:31,172] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:15:31,178] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 5.523 seconds
[2022-03-19 21:16:53,133] {processor.py:163} INFO - Started process (PID=53065) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:16:53,135] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:16:53,135] {logging_mixin.py:109} INFO - [2022-03-19 21:16:53,135] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:16:58,195] {logging_mixin.py:109} INFO - [2022-03-19 21:16:58,189] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:16:58,217] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:16:58,222] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 5.089 seconds
[2022-03-19 21:18:16,860] {processor.py:163} INFO - Started process (PID=53123) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:18:16,860] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:18:16,861] {logging_mixin.py:109} INFO - [2022-03-19 21:18:16,861] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:18:20,973] {logging_mixin.py:109} INFO - [2022-03-19 21:18:20,966] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:18:20,996] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:18:21,001] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.141 seconds
[2022-03-19 21:19:37,895] {processor.py:163} INFO - Started process (PID=53203) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:19:37,896] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:19:37,896] {logging_mixin.py:109} INFO - [2022-03-19 21:19:37,896] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:19:42,472] {logging_mixin.py:109} INFO - [2022-03-19 21:19:42,465] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:19:42,496] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:19:42,501] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.607 seconds
[2022-03-19 21:20:59,334] {processor.py:163} INFO - Started process (PID=53271) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:20:59,335] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:20:59,335] {logging_mixin.py:109} INFO - [2022-03-19 21:20:59,335] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:21:03,648] {logging_mixin.py:109} INFO - [2022-03-19 21:21:03,642] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:21:03,673] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:21:03,677] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.344 seconds
[2022-03-19 21:22:20,341] {processor.py:163} INFO - Started process (PID=53332) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:22:20,343] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:22:20,343] {logging_mixin.py:109} INFO - [2022-03-19 21:22:20,343] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:22:24,885] {logging_mixin.py:109} INFO - [2022-03-19 21:22:24,879] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:22:24,907] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:22:24,912] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.572 seconds
[2022-03-19 21:23:41,727] {processor.py:163} INFO - Started process (PID=53394) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:23:41,729] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:23:41,729] {logging_mixin.py:109} INFO - [2022-03-19 21:23:41,729] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:23:46,942] {logging_mixin.py:109} INFO - [2022-03-19 21:23:46,936] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:23:46,964] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:23:46,969] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 5.243 seconds
[2022-03-19 21:25:05,507] {processor.py:163} INFO - Started process (PID=53457) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:25:05,511] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:25:05,511] {logging_mixin.py:109} INFO - [2022-03-19 21:25:05,511] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:25:10,675] {logging_mixin.py:109} INFO - [2022-03-19 21:25:10,667] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:25:10,698] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:25:10,702] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 5.196 seconds
[2022-03-19 21:26:29,592] {processor.py:163} INFO - Started process (PID=53533) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:26:29,595] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:26:29,595] {logging_mixin.py:109} INFO - [2022-03-19 21:26:29,595] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:26:35,007] {logging_mixin.py:109} INFO - [2022-03-19 21:26:35,001] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:26:35,032] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:26:35,042] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 5.450 seconds
[2022-03-19 21:27:53,766] {processor.py:163} INFO - Started process (PID=53592) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:27:53,767] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:27:53,768] {logging_mixin.py:109} INFO - [2022-03-19 21:27:53,768] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:27:58,199] {logging_mixin.py:109} INFO - [2022-03-19 21:27:58,197] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:27:58,220] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:27:58,226] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.461 seconds
[2022-03-19 21:29:14,792] {processor.py:163} INFO - Started process (PID=53651) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:29:14,792] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:29:14,792] {logging_mixin.py:109} INFO - [2022-03-19 21:29:14,792] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:29:18,277] {logging_mixin.py:109} INFO - [2022-03-19 21:29:18,275] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:29:18,299] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:29:18,304] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.513 seconds
[2022-03-19 21:30:34,832] {processor.py:163} INFO - Started process (PID=53713) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:30:34,832] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:30:34,833] {logging_mixin.py:109} INFO - [2022-03-19 21:30:34,832] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:30:38,476] {logging_mixin.py:109} INFO - [2022-03-19 21:30:38,474] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:30:38,498] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:30:38,503] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.672 seconds
[2022-03-19 21:31:55,559] {processor.py:163} INFO - Started process (PID=53782) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:31:55,560] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:31:55,561] {logging_mixin.py:109} INFO - [2022-03-19 21:31:55,561] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:32:00,322] {logging_mixin.py:109} INFO - [2022-03-19 21:32:00,319] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:32:00,347] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:32:00,352] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.794 seconds
[2022-03-19 21:33:19,585] {processor.py:163} INFO - Started process (PID=53840) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:33:19,586] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:33:19,586] {logging_mixin.py:109} INFO - [2022-03-19 21:33:19,586] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:33:23,246] {logging_mixin.py:109} INFO - [2022-03-19 21:33:23,243] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:33:23,267] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:33:23,273] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.688 seconds
[2022-03-19 21:34:41,693] {processor.py:163} INFO - Started process (PID=53946) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:34:41,694] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:34:41,695] {logging_mixin.py:109} INFO - [2022-03-19 21:34:41,695] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:34:45,926] {logging_mixin.py:109} INFO - [2022-03-19 21:34:45,923] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:34:45,949] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:34:45,954] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.261 seconds
[2022-03-19 21:36:05,034] {processor.py:163} INFO - Started process (PID=54007) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:36:05,035] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:36:05,035] {logging_mixin.py:109} INFO - [2022-03-19 21:36:05,035] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:36:08,963] {logging_mixin.py:109} INFO - [2022-03-19 21:36:08,961] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:36:08,987] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:36:08,993] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.959 seconds
[2022-03-19 21:37:26,186] {processor.py:163} INFO - Started process (PID=54062) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:37:26,186] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:37:26,186] {logging_mixin.py:109} INFO - [2022-03-19 21:37:26,186] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:37:30,356] {logging_mixin.py:109} INFO - [2022-03-19 21:37:30,354] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:37:30,380] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:37:30,385] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.199 seconds
[2022-03-19 21:38:47,621] {processor.py:163} INFO - Started process (PID=54118) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:38:47,622] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:38:47,622] {logging_mixin.py:109} INFO - [2022-03-19 21:38:47,622] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:38:51,616] {logging_mixin.py:109} INFO - [2022-03-19 21:38:51,614] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:38:51,642] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:38:51,647] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.026 seconds
[2022-03-19 21:40:08,842] {processor.py:163} INFO - Started process (PID=54179) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:40:08,842] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:40:08,843] {logging_mixin.py:109} INFO - [2022-03-19 21:40:08,843] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:40:13,206] {logging_mixin.py:109} INFO - [2022-03-19 21:40:13,204] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:40:13,228] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:40:13,235] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.393 seconds
[2022-03-19 21:41:30,504] {processor.py:163} INFO - Started process (PID=54257) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:41:30,504] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:41:30,505] {logging_mixin.py:109} INFO - [2022-03-19 21:41:30,505] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:41:34,901] {logging_mixin.py:109} INFO - [2022-03-19 21:41:34,898] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:41:34,927] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:41:34,933] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.429 seconds
[2022-03-19 21:42:52,201] {processor.py:163} INFO - Started process (PID=54318) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:42:52,202] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:42:52,202] {logging_mixin.py:109} INFO - [2022-03-19 21:42:52,202] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:42:56,516] {logging_mixin.py:109} INFO - [2022-03-19 21:42:56,514] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:42:56,540] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:42:56,547] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.346 seconds
[2022-03-19 21:44:13,684] {processor.py:163} INFO - Started process (PID=54374) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:44:13,684] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:44:13,685] {logging_mixin.py:109} INFO - [2022-03-19 21:44:13,685] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:44:17,535] {logging_mixin.py:109} INFO - [2022-03-19 21:44:17,533] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:44:17,558] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:44:17,562] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.879 seconds
[2022-03-19 21:45:34,739] {processor.py:163} INFO - Started process (PID=54436) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:45:34,739] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:45:34,740] {logging_mixin.py:109} INFO - [2022-03-19 21:45:34,740] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:45:38,950] {logging_mixin.py:109} INFO - [2022-03-19 21:45:38,948] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:45:38,976] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:45:38,981] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.243 seconds
[2022-03-19 21:46:56,044] {processor.py:163} INFO - Started process (PID=54499) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:46:56,044] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:46:56,044] {logging_mixin.py:109} INFO - [2022-03-19 21:46:56,044] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:47:00,037] {logging_mixin.py:109} INFO - [2022-03-19 21:47:00,034] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:47:00,059] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:47:00,065] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.022 seconds
[2022-03-19 21:48:17,212] {processor.py:163} INFO - Started process (PID=54557) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:48:17,213] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:48:17,213] {logging_mixin.py:109} INFO - [2022-03-19 21:48:17,213] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:48:21,271] {logging_mixin.py:109} INFO - [2022-03-19 21:48:21,269] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:48:21,292] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:48:21,297] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.086 seconds
[2022-03-19 21:49:38,405] {processor.py:163} INFO - Started process (PID=54619) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:49:38,406] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:49:38,406] {logging_mixin.py:109} INFO - [2022-03-19 21:49:38,406] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:49:42,470] {logging_mixin.py:109} INFO - [2022-03-19 21:49:42,468] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:49:42,494] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:49:42,499] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.095 seconds
[2022-03-19 21:50:59,557] {processor.py:163} INFO - Started process (PID=54679) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:50:59,557] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:50:59,557] {logging_mixin.py:109} INFO - [2022-03-19 21:50:59,557] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:51:03,522] {logging_mixin.py:109} INFO - [2022-03-19 21:51:03,519] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:51:03,546] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:51:03,551] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.996 seconds
[2022-03-19 21:52:20,658] {processor.py:163} INFO - Started process (PID=54739) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:52:20,658] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:52:20,659] {logging_mixin.py:109} INFO - [2022-03-19 21:52:20,659] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:52:24,656] {logging_mixin.py:109} INFO - [2022-03-19 21:52:24,653] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:52:24,678] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:52:24,684] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.027 seconds
[2022-03-19 21:53:41,778] {processor.py:163} INFO - Started process (PID=54821) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:53:41,779] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:53:41,779] {logging_mixin.py:109} INFO - [2022-03-19 21:53:41,779] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:53:45,938] {logging_mixin.py:109} INFO - [2022-03-19 21:53:45,935] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:53:45,961] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:53:45,966] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.188 seconds
[2022-03-19 21:55:03,037] {processor.py:163} INFO - Started process (PID=54908) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:55:03,037] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:55:03,038] {logging_mixin.py:109} INFO - [2022-03-19 21:55:03,038] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:55:06,990] {logging_mixin.py:109} INFO - [2022-03-19 21:55:06,987] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:55:07,017] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:55:07,023] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.986 seconds
[2022-03-19 21:56:24,175] {processor.py:163} INFO - Started process (PID=54973) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:56:24,176] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:56:24,176] {logging_mixin.py:109} INFO - [2022-03-19 21:56:24,176] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:56:28,531] {logging_mixin.py:109} INFO - [2022-03-19 21:56:28,529] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:56:28,554] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:56:28,564] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.390 seconds
[2022-03-19 21:57:45,659] {processor.py:163} INFO - Started process (PID=55030) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:57:45,659] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:57:45,659] {logging_mixin.py:109} INFO - [2022-03-19 21:57:45,659] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:57:49,348] {logging_mixin.py:109} INFO - [2022-03-19 21:57:49,346] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:57:49,371] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:57:49,376] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.718 seconds
[2022-03-19 21:59:06,501] {processor.py:163} INFO - Started process (PID=55087) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:59:06,501] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 21:59:06,502] {logging_mixin.py:109} INFO - [2022-03-19 21:59:06,502] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:59:10,836] {logging_mixin.py:109} INFO - [2022-03-19 21:59:10,834] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 21:59:10,859] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 21:59:10,864] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.364 seconds
[2022-03-19 22:00:27,994] {processor.py:163} INFO - Started process (PID=55146) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:00:27,994] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:00:27,995] {logging_mixin.py:109} INFO - [2022-03-19 22:00:27,995] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:00:31,751] {logging_mixin.py:109} INFO - [2022-03-19 22:00:31,749] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:00:31,776] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:00:31,780] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.787 seconds
[2022-03-19 22:01:48,817] {processor.py:163} INFO - Started process (PID=55214) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:01:48,817] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:01:48,818] {logging_mixin.py:109} INFO - [2022-03-19 22:01:48,818] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:01:53,125] {logging_mixin.py:109} INFO - [2022-03-19 22:01:53,123] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:01:53,150] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:01:53,155] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.338 seconds
[2022-03-19 22:03:10,235] {processor.py:163} INFO - Started process (PID=55269) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:03:10,236] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:03:10,236] {logging_mixin.py:109} INFO - [2022-03-19 22:03:10,236] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:03:13,950] {logging_mixin.py:109} INFO - [2022-03-19 22:03:13,948] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:03:13,973] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:03:13,978] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.744 seconds
[2022-03-19 22:04:31,047] {processor.py:163} INFO - Started process (PID=55327) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:04:31,048] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:04:31,048] {logging_mixin.py:109} INFO - [2022-03-19 22:04:31,048] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:04:35,127] {logging_mixin.py:109} INFO - [2022-03-19 22:04:35,125] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:04:35,151] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:04:35,156] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.109 seconds
[2022-03-19 22:05:52,421] {processor.py:163} INFO - Started process (PID=55387) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:05:52,421] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:05:52,422] {logging_mixin.py:109} INFO - [2022-03-19 22:05:52,422] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:05:56,823] {logging_mixin.py:109} INFO - [2022-03-19 22:05:56,821] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:05:56,849] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:05:56,855] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.435 seconds
[2022-03-19 22:07:13,441] {processor.py:163} INFO - Started process (PID=55446) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:07:13,441] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:07:13,441] {logging_mixin.py:109} INFO - [2022-03-19 22:07:13,441] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:07:17,215] {logging_mixin.py:109} INFO - [2022-03-19 22:07:17,213] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:07:17,242] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:07:17,247] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.806 seconds
[2022-03-19 22:08:33,836] {processor.py:163} INFO - Started process (PID=55519) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:08:33,836] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:08:33,837] {logging_mixin.py:109} INFO - [2022-03-19 22:08:33,837] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:08:37,758] {logging_mixin.py:109} INFO - [2022-03-19 22:08:37,756] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:08:37,779] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:08:37,783] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.948 seconds
[2022-03-19 22:09:54,792] {processor.py:163} INFO - Started process (PID=55577) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:09:54,792] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:09:54,793] {logging_mixin.py:109} INFO - [2022-03-19 22:09:54,793] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:09:58,796] {logging_mixin.py:109} INFO - [2022-03-19 22:09:58,794] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:09:58,820] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:09:58,825] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.033 seconds
[2022-03-19 22:11:15,889] {processor.py:163} INFO - Started process (PID=55635) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:11:15,890] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:11:15,890] {logging_mixin.py:109} INFO - [2022-03-19 22:11:15,890] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:11:20,049] {logging_mixin.py:109} INFO - [2022-03-19 22:11:20,047] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:11:20,072] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:11:20,077] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.189 seconds
[2022-03-19 22:12:37,203] {processor.py:163} INFO - Started process (PID=55696) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:12:37,203] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:12:37,203] {logging_mixin.py:109} INFO - [2022-03-19 22:12:37,203] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:12:41,456] {logging_mixin.py:109} INFO - [2022-03-19 22:12:41,454] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:12:41,481] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:12:41,486] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.284 seconds
[2022-03-19 22:13:58,530] {processor.py:163} INFO - Started process (PID=55776) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:13:58,530] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:13:58,531] {logging_mixin.py:109} INFO - [2022-03-19 22:13:58,531] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:14:02,382] {logging_mixin.py:109} INFO - [2022-03-19 22:14:02,380] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:14:02,406] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:14:02,412] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.882 seconds
[2022-03-19 22:15:19,545] {processor.py:163} INFO - Started process (PID=55860) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:15:19,546] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:15:19,546] {logging_mixin.py:109} INFO - [2022-03-19 22:15:19,546] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:15:23,882] {logging_mixin.py:109} INFO - [2022-03-19 22:15:23,879] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:15:23,904] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:15:23,909] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.364 seconds
[2022-03-19 22:16:41,067] {processor.py:163} INFO - Started process (PID=55926) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:16:41,067] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:16:41,067] {logging_mixin.py:109} INFO - [2022-03-19 22:16:41,067] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:16:45,147] {logging_mixin.py:109} INFO - [2022-03-19 22:16:45,145] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:16:45,170] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:16:45,175] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.109 seconds
[2022-03-19 22:18:02,315] {processor.py:163} INFO - Started process (PID=55983) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:18:02,316] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:18:02,316] {logging_mixin.py:109} INFO - [2022-03-19 22:18:02,316] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:18:06,101] {logging_mixin.py:109} INFO - [2022-03-19 22:18:06,099] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:18:06,126] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:18:06,131] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.816 seconds
[2022-03-19 22:19:24,371] {processor.py:163} INFO - Started process (PID=56039) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:19:24,371] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:19:24,371] {logging_mixin.py:109} INFO - [2022-03-19 22:19:24,371] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:19:28,118] {logging_mixin.py:109} INFO - [2022-03-19 22:19:28,116] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:19:28,141] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:19:28,146] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.776 seconds
[2022-03-19 22:20:45,182] {processor.py:163} INFO - Started process (PID=56099) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:20:45,182] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:20:45,182] {logging_mixin.py:109} INFO - [2022-03-19 22:20:45,182] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:20:49,460] {logging_mixin.py:109} INFO - [2022-03-19 22:20:49,458] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:20:49,482] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:20:49,487] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.306 seconds
[2022-03-19 22:22:06,563] {processor.py:163} INFO - Started process (PID=56159) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:22:06,564] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:22:06,564] {logging_mixin.py:109} INFO - [2022-03-19 22:22:06,564] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:22:10,498] {logging_mixin.py:109} INFO - [2022-03-19 22:22:10,496] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:22:10,520] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:22:10,525] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.962 seconds
[2022-03-19 22:23:27,605] {processor.py:163} INFO - Started process (PID=56216) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:23:27,605] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:23:27,606] {logging_mixin.py:109} INFO - [2022-03-19 22:23:27,606] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:23:31,704] {logging_mixin.py:109} INFO - [2022-03-19 22:23:31,701] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:23:31,728] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:23:31,734] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.129 seconds
[2022-03-19 22:24:48,807] {processor.py:163} INFO - Started process (PID=56273) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:24:48,807] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:24:48,807] {logging_mixin.py:109} INFO - [2022-03-19 22:24:48,807] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:24:52,750] {logging_mixin.py:109} INFO - [2022-03-19 22:24:52,748] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:24:52,774] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:24:52,778] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.972 seconds
[2022-03-19 22:26:09,892] {processor.py:163} INFO - Started process (PID=56337) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:26:09,893] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:26:09,893] {logging_mixin.py:109} INFO - [2022-03-19 22:26:09,893] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:26:14,053] {logging_mixin.py:109} INFO - [2022-03-19 22:26:14,051] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:26:14,078] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:26:14,084] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.192 seconds
[2022-03-19 22:27:31,218] {processor.py:163} INFO - Started process (PID=56397) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:27:31,218] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:27:31,218] {logging_mixin.py:109} INFO - [2022-03-19 22:27:31,218] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:27:35,363] {logging_mixin.py:109} INFO - [2022-03-19 22:27:35,361] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:27:35,386] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:27:35,390] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.173 seconds
[2022-03-19 22:28:52,560] {processor.py:163} INFO - Started process (PID=56454) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:28:52,560] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:28:52,560] {logging_mixin.py:109} INFO - [2022-03-19 22:28:52,560] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:28:56,479] {logging_mixin.py:109} INFO - [2022-03-19 22:28:56,477] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:28:56,501] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:28:56,506] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.947 seconds
[2022-03-19 22:30:13,643] {processor.py:163} INFO - Started process (PID=56515) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:30:13,643] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:30:13,644] {logging_mixin.py:109} INFO - [2022-03-19 22:30:13,644] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:30:17,655] {logging_mixin.py:109} INFO - [2022-03-19 22:30:17,653] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:30:17,678] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:30:17,683] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.040 seconds
[2022-03-19 22:31:34,883] {processor.py:163} INFO - Started process (PID=56578) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:31:34,883] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:31:34,884] {logging_mixin.py:109} INFO - [2022-03-19 22:31:34,884] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:31:38,941] {logging_mixin.py:109} INFO - [2022-03-19 22:31:38,939] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:31:38,964] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:31:38,969] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.086 seconds
[2022-03-19 22:32:56,047] {processor.py:163} INFO - Started process (PID=56639) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:32:56,047] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:32:56,048] {logging_mixin.py:109} INFO - [2022-03-19 22:32:56,048] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:32:59,996] {logging_mixin.py:109} INFO - [2022-03-19 22:32:59,994] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:33:00,019] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:33:00,024] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.977 seconds
[2022-03-19 22:34:16,700] {processor.py:163} INFO - Started process (PID=56744) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:34:16,700] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:34:16,700] {logging_mixin.py:109} INFO - [2022-03-19 22:34:16,700] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:34:20,634] {logging_mixin.py:109} INFO - [2022-03-19 22:34:20,632] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:34:20,659] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:34:20,664] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.965 seconds
[2022-03-19 22:35:37,830] {processor.py:163} INFO - Started process (PID=56817) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:35:37,832] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:35:37,833] {logging_mixin.py:109} INFO - [2022-03-19 22:35:37,832] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:35:41,936] {logging_mixin.py:109} INFO - [2022-03-19 22:35:41,933] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:35:41,959] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:35:41,964] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.134 seconds
[2022-03-19 22:36:59,114] {processor.py:163} INFO - Started process (PID=56880) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:36:59,114] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:36:59,115] {logging_mixin.py:109} INFO - [2022-03-19 22:36:59,115] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:37:03,372] {logging_mixin.py:109} INFO - [2022-03-19 22:37:03,369] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:37:03,394] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:37:03,398] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.285 seconds
[2022-03-19 22:38:20,500] {processor.py:163} INFO - Started process (PID=56937) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:38:20,501] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:38:20,501] {logging_mixin.py:109} INFO - [2022-03-19 22:38:20,501] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:38:24,322] {logging_mixin.py:109} INFO - [2022-03-19 22:38:24,320] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:38:24,345] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:38:24,350] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.850 seconds
[2022-03-19 22:39:41,601] {processor.py:163} INFO - Started process (PID=56999) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:39:41,601] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:39:41,601] {logging_mixin.py:109} INFO - [2022-03-19 22:39:41,601] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:39:45,724] {logging_mixin.py:109} INFO - [2022-03-19 22:39:45,721] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:39:45,747] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:39:45,752] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.152 seconds
[2022-03-19 22:41:02,818] {processor.py:163} INFO - Started process (PID=57057) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:41:02,818] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:41:02,818] {logging_mixin.py:109} INFO - [2022-03-19 22:41:02,818] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:41:06,782] {logging_mixin.py:109} INFO - [2022-03-19 22:41:06,780] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:41:06,806] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:41:06,811] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.994 seconds
[2022-03-19 22:42:23,881] {processor.py:163} INFO - Started process (PID=57121) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:42:23,881] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:42:23,882] {logging_mixin.py:109} INFO - [2022-03-19 22:42:23,881] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:42:27,876] {logging_mixin.py:109} INFO - [2022-03-19 22:42:27,874] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:42:27,900] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:42:27,905] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.025 seconds
[2022-03-19 22:43:45,036] {processor.py:163} INFO - Started process (PID=57181) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:43:45,037] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:43:45,037] {logging_mixin.py:109} INFO - [2022-03-19 22:43:45,037] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:43:49,134] {logging_mixin.py:109} INFO - [2022-03-19 22:43:49,131] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:43:49,156] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:43:49,161] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.125 seconds
[2022-03-19 22:45:06,312] {processor.py:163} INFO - Started process (PID=57241) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:45:06,313] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:45:06,313] {logging_mixin.py:109} INFO - [2022-03-19 22:45:06,313] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:45:10,179] {logging_mixin.py:109} INFO - [2022-03-19 22:45:10,177] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:45:10,202] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:45:10,207] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.895 seconds
[2022-03-19 22:46:27,369] {processor.py:163} INFO - Started process (PID=57296) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:46:27,369] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:46:27,370] {logging_mixin.py:109} INFO - [2022-03-19 22:46:27,370] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:46:31,409] {logging_mixin.py:109} INFO - [2022-03-19 22:46:31,407] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:46:31,433] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:46:31,438] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.070 seconds
[2022-03-19 22:47:48,567] {processor.py:163} INFO - Started process (PID=57361) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:47:48,567] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:47:48,568] {logging_mixin.py:109} INFO - [2022-03-19 22:47:48,568] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:47:52,700] {logging_mixin.py:109} INFO - [2022-03-19 22:47:52,698] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:47:52,722] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:47:52,728] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.161 seconds
[2022-03-19 22:49:09,828] {processor.py:163} INFO - Started process (PID=57417) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:49:09,828] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:49:09,829] {logging_mixin.py:109} INFO - [2022-03-19 22:49:09,829] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:49:13,732] {logging_mixin.py:109} INFO - [2022-03-19 22:49:13,730] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:49:13,756] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:49:13,760] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.933 seconds
[2022-03-19 22:50:30,881] {processor.py:163} INFO - Started process (PID=57477) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:50:30,881] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:50:30,882] {logging_mixin.py:109} INFO - [2022-03-19 22:50:30,882] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:50:35,026] {logging_mixin.py:109} INFO - [2022-03-19 22:50:35,024] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:50:35,050] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:50:35,055] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.175 seconds
[2022-03-19 22:51:52,195] {processor.py:163} INFO - Started process (PID=57534) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:51:52,196] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:51:52,196] {logging_mixin.py:109} INFO - [2022-03-19 22:51:52,196] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:51:56,108] {logging_mixin.py:109} INFO - [2022-03-19 22:51:56,105] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:51:56,131] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:51:56,136] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.941 seconds
[2022-03-19 22:53:13,244] {processor.py:163} INFO - Started process (PID=57594) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:53:13,245] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:53:13,245] {logging_mixin.py:109} INFO - [2022-03-19 22:53:13,245] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:53:17,628] {logging_mixin.py:109} INFO - [2022-03-19 22:53:17,626] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:53:17,655] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:53:17,660] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.416 seconds
[2022-03-19 22:54:34,742] {processor.py:163} INFO - Started process (PID=57698) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:54:34,743] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:54:34,743] {logging_mixin.py:109} INFO - [2022-03-19 22:54:34,743] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:54:38,779] {logging_mixin.py:109} INFO - [2022-03-19 22:54:38,775] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:54:38,805] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:54:38,810] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.068 seconds
[2022-03-19 22:55:55,837] {processor.py:163} INFO - Started process (PID=57761) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:55:55,837] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:55:55,837] {logging_mixin.py:109} INFO - [2022-03-19 22:55:55,837] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:55:59,834] {logging_mixin.py:109} INFO - [2022-03-19 22:55:59,832] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:55:59,856] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:55:59,862] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.026 seconds
[2022-03-19 22:57:17,138] {processor.py:163} INFO - Started process (PID=57818) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:57:17,138] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:57:17,139] {logging_mixin.py:109} INFO - [2022-03-19 22:57:17,139] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:57:21,485] {logging_mixin.py:109} INFO - [2022-03-19 22:57:21,483] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:57:21,509] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:57:21,514] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.376 seconds
[2022-03-19 22:58:38,669] {processor.py:163} INFO - Started process (PID=57888) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:58:38,669] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:58:38,669] {logging_mixin.py:109} INFO - [2022-03-19 22:58:38,669] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:58:42,646] {logging_mixin.py:109} INFO - [2022-03-19 22:58:42,644] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 22:58:42,670] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:58:42,676] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.008 seconds
[2022-03-19 22:59:59,787] {processor.py:163} INFO - Started process (PID=57948) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 22:59:59,788] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 22:59:59,788] {logging_mixin.py:109} INFO - [2022-03-19 22:59:59,788] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:00:03,547] {logging_mixin.py:109} INFO - [2022-03-19 23:00:03,545] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 23:00:03,570] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:00:03,575] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.788 seconds
[2022-03-19 23:01:20,742] {processor.py:163} INFO - Started process (PID=58009) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:01:20,743] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 23:01:20,743] {logging_mixin.py:109} INFO - [2022-03-19 23:01:20,743] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:01:24,658] {logging_mixin.py:109} INFO - [2022-03-19 23:01:24,656] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 23:01:24,682] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:01:24,687] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.945 seconds
[2022-03-19 23:02:41,938] {processor.py:163} INFO - Started process (PID=58077) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:02:41,939] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 23:02:41,939] {logging_mixin.py:109} INFO - [2022-03-19 23:02:41,939] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:02:45,769] {logging_mixin.py:109} INFO - [2022-03-19 23:02:45,766] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 23:02:45,792] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:02:45,797] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.859 seconds
[2022-03-19 23:04:02,986] {processor.py:163} INFO - Started process (PID=58133) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:04:02,986] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 23:04:02,987] {logging_mixin.py:109} INFO - [2022-03-19 23:04:02,987] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:04:06,949] {logging_mixin.py:109} INFO - [2022-03-19 23:04:06,947] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 23:04:06,974] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:04:06,978] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.993 seconds
[2022-03-19 23:05:24,126] {processor.py:163} INFO - Started process (PID=58194) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:05:24,126] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 23:05:24,126] {logging_mixin.py:109} INFO - [2022-03-19 23:05:24,126] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:05:27,962] {logging_mixin.py:109} INFO - [2022-03-19 23:05:27,959] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 23:05:27,986] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:05:27,992] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.867 seconds
[2022-03-19 23:06:45,055] {processor.py:163} INFO - Started process (PID=58249) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:06:45,056] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 23:06:45,056] {logging_mixin.py:109} INFO - [2022-03-19 23:06:45,056] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:06:48,886] {logging_mixin.py:109} INFO - [2022-03-19 23:06:48,884] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 23:06:48,910] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:06:48,916] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.861 seconds
[2022-03-19 23:08:06,015] {processor.py:163} INFO - Started process (PID=58309) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:08:06,015] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 23:08:06,015] {logging_mixin.py:109} INFO - [2022-03-19 23:08:06,015] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:08:09,801] {logging_mixin.py:109} INFO - [2022-03-19 23:08:09,798] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 23:08:09,824] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:08:09,830] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.816 seconds
[2022-03-19 23:09:27,038] {processor.py:163} INFO - Started process (PID=58365) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:09:27,039] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 23:09:27,039] {logging_mixin.py:109} INFO - [2022-03-19 23:09:27,039] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:09:30,981] {logging_mixin.py:109} INFO - [2022-03-19 23:09:30,978] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 23:09:31,005] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:09:31,011] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.973 seconds
[2022-03-19 23:10:49,091] {processor.py:163} INFO - Started process (PID=58428) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:10:49,091] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 23:10:49,091] {logging_mixin.py:109} INFO - [2022-03-19 23:10:49,091] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:10:53,097] {logging_mixin.py:109} INFO - [2022-03-19 23:10:53,095] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 23:10:53,121] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:10:53,127] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.036 seconds
[2022-03-19 23:12:10,280] {processor.py:163} INFO - Started process (PID=58483) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:12:10,280] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 23:12:10,281] {logging_mixin.py:109} INFO - [2022-03-19 23:12:10,281] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:12:14,107] {logging_mixin.py:109} INFO - [2022-03-19 23:12:14,105] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 23:12:14,130] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:12:14,136] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.856 seconds
[2022-03-19 23:13:31,332] {processor.py:163} INFO - Started process (PID=58570) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:13:31,332] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 23:13:31,332] {logging_mixin.py:109} INFO - [2022-03-19 23:13:31,332] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:13:35,567] {logging_mixin.py:109} INFO - [2022-03-19 23:13:35,564] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 23:13:35,590] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:13:35,594] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.263 seconds
[2022-03-19 23:14:52,760] {processor.py:163} INFO - Started process (PID=58653) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:14:52,760] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 23:14:52,761] {logging_mixin.py:109} INFO - [2022-03-19 23:14:52,761] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:14:56,536] {logging_mixin.py:109} INFO - [2022-03-19 23:14:56,534] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 23:14:56,559] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:14:56,565] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.805 seconds
[2022-03-19 23:16:13,722] {processor.py:163} INFO - Started process (PID=58710) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:16:13,722] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 23:16:13,722] {logging_mixin.py:109} INFO - [2022-03-19 23:16:13,722] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:16:17,802] {logging_mixin.py:109} INFO - [2022-03-19 23:16:17,799] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 23:16:17,827] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:16:17,832] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.111 seconds
[2022-03-19 23:17:34,955] {processor.py:163} INFO - Started process (PID=58771) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:17:34,955] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 23:17:34,955] {logging_mixin.py:109} INFO - [2022-03-19 23:17:34,955] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:17:39,027] {logging_mixin.py:109} INFO - [2022-03-19 23:17:39,024] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 23:17:39,050] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:17:39,055] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.100 seconds
[2022-03-19 23:18:56,136] {processor.py:163} INFO - Started process (PID=58831) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:18:56,136] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-19 23:18:56,136] {logging_mixin.py:109} INFO - [2022-03-19 23:18:56,136] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:19:00,304] {logging_mixin.py:109} INFO - [2022-03-19 23:19:00,302] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-19 23:19:00,328] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-19 23:19:00,333] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.198 seconds
