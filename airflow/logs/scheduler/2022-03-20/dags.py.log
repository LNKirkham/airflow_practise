[2022-03-20 11:13:19,463] {processor.py:163} INFO - Started process (PID=58994) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:13:19,463] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 11:13:19,464] {logging_mixin.py:109} INFO - [2022-03-20 11:13:19,464] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:13:23,905] {logging_mixin.py:109} INFO - [2022-03-20 11:13:23,901] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 11:13:23,932] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:13:23,937] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.475 seconds
[2022-03-20 11:14:49,013] {processor.py:163} INFO - Started process (PID=59106) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:14:49,014] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 11:14:49,014] {logging_mixin.py:109} INFO - [2022-03-20 11:14:49,014] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:14:55,216] {logging_mixin.py:109} INFO - [2022-03-20 11:14:55,207] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 11:14:55,242] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:14:55,247] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 6.235 seconds
[2022-03-20 11:16:24,635] {processor.py:163} INFO - Started process (PID=59191) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:16:24,636] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 11:16:24,637] {logging_mixin.py:109} INFO - [2022-03-20 11:16:24,636] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:16:30,400] {logging_mixin.py:109} INFO - [2022-03-20 11:16:30,393] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 11:16:30,438] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:16:30,445] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 5.811 seconds
[2022-03-20 11:17:58,928] {processor.py:163} INFO - Started process (PID=59271) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:17:58,929] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 11:17:58,930] {logging_mixin.py:109} INFO - [2022-03-20 11:17:58,929] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:18:04,913] {logging_mixin.py:109} INFO - [2022-03-20 11:18:04,905] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 11:18:04,937] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:18:04,941] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 6.014 seconds
[2022-03-20 11:19:24,265] {processor.py:163} INFO - Started process (PID=59329) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:19:24,265] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 11:19:24,266] {logging_mixin.py:109} INFO - [2022-03-20 11:19:24,266] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:19:28,259] {logging_mixin.py:109} INFO - [2022-03-20 11:19:28,257] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 11:19:28,283] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:19:28,289] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.025 seconds
[2022-03-20 11:20:45,646] {processor.py:163} INFO - Started process (PID=59386) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:20:45,646] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 11:20:45,646] {logging_mixin.py:109} INFO - [2022-03-20 11:20:45,646] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:20:49,385] {logging_mixin.py:109} INFO - [2022-03-20 11:20:49,383] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 11:20:49,410] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:20:49,415] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.770 seconds
[2022-03-20 11:22:06,169] {processor.py:163} INFO - Started process (PID=59443) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:22:06,170] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 11:22:06,170] {logging_mixin.py:109} INFO - [2022-03-20 11:22:06,170] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:22:09,941] {logging_mixin.py:109} INFO - [2022-03-20 11:22:09,938] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 11:22:09,966] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:22:09,972] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.803 seconds
[2022-03-20 11:23:26,652] {processor.py:163} INFO - Started process (PID=59504) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:23:26,652] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 11:23:26,653] {logging_mixin.py:109} INFO - [2022-03-20 11:23:26,653] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:23:30,256] {logging_mixin.py:109} INFO - [2022-03-20 11:23:30,254] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 11:23:30,276] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:23:30,281] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.630 seconds
[2022-03-20 11:24:46,943] {processor.py:163} INFO - Started process (PID=59567) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:24:46,943] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 11:24:46,943] {logging_mixin.py:109} INFO - [2022-03-20 11:24:46,943] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:24:50,750] {logging_mixin.py:109} INFO - [2022-03-20 11:24:50,747] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 11:24:50,771] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:24:50,776] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.834 seconds
[2022-03-20 11:26:07,704] {processor.py:163} INFO - Started process (PID=59657) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:26:07,706] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 11:26:07,706] {logging_mixin.py:109} INFO - [2022-03-20 11:26:07,706] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:26:13,282] {logging_mixin.py:109} INFO - [2022-03-20 11:26:13,274] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 11:26:13,305] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:26:13,310] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 5.607 seconds
[2022-03-20 11:27:32,219] {processor.py:163} INFO - Started process (PID=59745) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:27:32,221] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 11:27:32,221] {logging_mixin.py:109} INFO - [2022-03-20 11:27:32,221] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:27:37,661] {logging_mixin.py:109} INFO - [2022-03-20 11:27:37,654] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 11:27:37,682] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:27:37,687] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 5.469 seconds
[2022-03-20 11:28:56,471] {processor.py:163} INFO - Started process (PID=59813) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:28:56,473] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 11:28:56,473] {logging_mixin.py:109} INFO - [2022-03-20 11:28:56,473] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:29:01,639] {logging_mixin.py:109} INFO - [2022-03-20 11:29:01,633] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 11:29:01,662] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:29:01,666] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 5.196 seconds
[2022-03-20 11:30:20,314] {processor.py:163} INFO - Started process (PID=59874) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:30:20,316] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 11:30:20,317] {logging_mixin.py:109} INFO - [2022-03-20 11:30:20,317] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:30:25,747] {logging_mixin.py:109} INFO - [2022-03-20 11:30:25,740] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 11:30:25,769] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:30:25,774] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 5.460 seconds
[2022-03-20 11:31:44,404] {processor.py:163} INFO - Started process (PID=59932) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:31:44,404] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 11:31:44,404] {logging_mixin.py:109} INFO - [2022-03-20 11:31:44,404] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:31:48,915] {logging_mixin.py:109} INFO - [2022-03-20 11:31:48,908] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 11:31:48,938] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:31:48,945] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.542 seconds
[2022-03-20 11:33:05,514] {processor.py:163} INFO - Started process (PID=59991) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:33:05,515] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 11:33:05,515] {logging_mixin.py:109} INFO - [2022-03-20 11:33:05,515] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:33:09,588] {logging_mixin.py:109} INFO - [2022-03-20 11:33:09,585] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 11:33:09,608] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:33:09,613] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.100 seconds
[2022-03-20 11:34:26,267] {processor.py:163} INFO - Started process (PID=60048) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:34:26,267] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 11:34:26,267] {logging_mixin.py:109} INFO - [2022-03-20 11:34:26,267] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:34:29,846] {logging_mixin.py:109} INFO - [2022-03-20 11:34:29,843] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 11:34:29,868] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:34:29,873] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.606 seconds
[2022-03-20 11:35:46,624] {processor.py:163} INFO - Started process (PID=60139) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:35:46,626] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 11:35:46,626] {logging_mixin.py:109} INFO - [2022-03-20 11:35:46,626] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:35:50,817] {logging_mixin.py:109} INFO - [2022-03-20 11:35:50,815] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 11:35:50,840] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:35:50,845] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.221 seconds
[2022-03-20 11:37:07,538] {processor.py:163} INFO - Started process (PID=60196) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:37:07,538] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 11:37:07,539] {logging_mixin.py:109} INFO - [2022-03-20 11:37:07,538] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:37:11,413] {logging_mixin.py:109} INFO - [2022-03-20 11:37:11,411] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 11:37:11,437] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:37:11,442] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.905 seconds
[2022-03-20 11:38:28,070] {processor.py:163} INFO - Started process (PID=60257) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:38:28,070] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 11:38:28,071] {logging_mixin.py:109} INFO - [2022-03-20 11:38:28,071] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:38:31,997] {logging_mixin.py:109} INFO - [2022-03-20 11:38:31,995] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 11:38:32,020] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:38:32,024] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.955 seconds
[2022-03-20 11:39:48,662] {processor.py:163} INFO - Started process (PID=60320) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:39:48,662] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 11:39:48,662] {logging_mixin.py:109} INFO - [2022-03-20 11:39:48,662] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:39:52,505] {logging_mixin.py:109} INFO - [2022-03-20 11:39:52,503] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 11:39:52,529] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:39:52,534] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.873 seconds
[2022-03-20 11:41:09,193] {processor.py:163} INFO - Started process (PID=60375) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:41:09,193] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 11:41:09,193] {logging_mixin.py:109} INFO - [2022-03-20 11:41:09,193] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:41:13,096] {logging_mixin.py:109} INFO - [2022-03-20 11:41:13,094] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 11:41:13,118] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:41:13,123] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.931 seconds
[2022-03-20 11:42:29,694] {processor.py:163} INFO - Started process (PID=60432) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:42:29,695] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 11:42:29,695] {logging_mixin.py:109} INFO - [2022-03-20 11:42:29,695] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:42:33,187] {logging_mixin.py:109} INFO - [2022-03-20 11:42:33,185] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 11:42:33,208] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:42:33,214] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.523 seconds
[2022-03-20 11:43:49,709] {processor.py:163} INFO - Started process (PID=60494) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:43:49,709] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 11:43:49,709] {logging_mixin.py:109} INFO - [2022-03-20 11:43:49,709] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:43:53,382] {logging_mixin.py:109} INFO - [2022-03-20 11:43:53,380] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 11:43:53,403] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:43:53,408] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.700 seconds
[2022-03-20 11:45:09,973] {processor.py:163} INFO - Started process (PID=60553) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:45:09,974] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 11:45:09,974] {logging_mixin.py:109} INFO - [2022-03-20 11:45:09,974] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:45:13,623] {logging_mixin.py:109} INFO - [2022-03-20 11:45:13,621] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 11:45:13,647] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:45:13,652] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.679 seconds
[2022-03-20 11:46:30,228] {processor.py:163} INFO - Started process (PID=60642) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:46:30,229] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 11:46:30,229] {logging_mixin.py:109} INFO - [2022-03-20 11:46:30,229] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:46:34,435] {logging_mixin.py:109} INFO - [2022-03-20 11:46:34,432] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 11:46:34,457] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:46:34,461] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.234 seconds
[2022-03-20 11:47:51,196] {processor.py:163} INFO - Started process (PID=60726) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:47:51,197] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 11:47:51,197] {logging_mixin.py:109} INFO - [2022-03-20 11:47:51,197] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:47:55,121] {logging_mixin.py:109} INFO - [2022-03-20 11:47:55,118] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 11:47:55,143] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:47:55,147] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.952 seconds
[2022-03-20 11:49:11,837] {processor.py:163} INFO - Started process (PID=60782) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:49:11,837] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 11:49:11,837] {logging_mixin.py:109} INFO - [2022-03-20 11:49:11,837] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:49:15,735] {logging_mixin.py:109} INFO - [2022-03-20 11:49:15,733] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 11:49:15,757] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:49:15,761] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.925 seconds
[2022-03-20 11:50:32,303] {processor.py:163} INFO - Started process (PID=60841) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:50:32,303] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 11:50:32,304] {logging_mixin.py:109} INFO - [2022-03-20 11:50:32,303] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:50:36,203] {logging_mixin.py:109} INFO - [2022-03-20 11:50:36,200] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 11:50:36,224] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:50:36,229] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.927 seconds
[2022-03-20 11:51:52,806] {processor.py:163} INFO - Started process (PID=60898) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:51:52,806] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 11:51:52,807] {logging_mixin.py:109} INFO - [2022-03-20 11:51:52,807] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:51:56,557] {logging_mixin.py:109} INFO - [2022-03-20 11:51:56,555] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 11:51:56,579] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:51:56,584] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.778 seconds
[2022-03-20 11:53:13,173] {processor.py:163} INFO - Started process (PID=60959) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:53:13,173] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 11:53:13,174] {logging_mixin.py:109} INFO - [2022-03-20 11:53:13,174] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:53:17,075] {logging_mixin.py:109} INFO - [2022-03-20 11:53:17,072] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 11:53:17,097] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:53:17,102] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.929 seconds
[2022-03-20 11:54:33,884] {processor.py:163} INFO - Started process (PID=61020) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:54:33,884] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 11:54:33,884] {logging_mixin.py:109} INFO - [2022-03-20 11:54:33,884] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:54:37,884] {logging_mixin.py:109} INFO - [2022-03-20 11:54:37,882] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 11:54:37,907] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:54:37,912] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.029 seconds
[2022-03-20 11:55:54,559] {processor.py:163} INFO - Started process (PID=61082) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:55:54,560] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 11:55:54,560] {logging_mixin.py:109} INFO - [2022-03-20 11:55:54,560] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:55:58,320] {logging_mixin.py:109} INFO - [2022-03-20 11:55:58,318] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 11:55:58,342] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:55:58,347] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.789 seconds
[2022-03-20 11:57:15,102] {processor.py:163} INFO - Started process (PID=61139) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:57:15,102] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 11:57:15,102] {logging_mixin.py:109} INFO - [2022-03-20 11:57:15,102] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:57:19,035] {logging_mixin.py:109} INFO - [2022-03-20 11:57:19,033] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 11:57:19,059] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:57:19,063] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.962 seconds
[2022-03-20 11:58:35,622] {processor.py:163} INFO - Started process (PID=61201) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:58:35,622] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 11:58:35,622] {logging_mixin.py:109} INFO - [2022-03-20 11:58:35,622] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:58:39,495] {logging_mixin.py:109} INFO - [2022-03-20 11:58:39,493] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 11:58:39,518] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:58:39,523] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.902 seconds
[2022-03-20 11:59:56,171] {processor.py:163} INFO - Started process (PID=61262) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 11:59:56,171] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 11:59:56,171] {logging_mixin.py:109} INFO - [2022-03-20 11:59:56,171] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:00:00,201] {logging_mixin.py:109} INFO - [2022-03-20 12:00:00,199] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:00:00,222] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:00:00,227] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.057 seconds
[2022-03-20 12:01:16,867] {processor.py:163} INFO - Started process (PID=61319) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:01:16,868] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:01:16,868] {logging_mixin.py:109} INFO - [2022-03-20 12:01:16,868] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:01:20,531] {logging_mixin.py:109} INFO - [2022-03-20 12:01:20,529] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:01:20,553] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:01:20,559] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.692 seconds
[2022-03-20 12:02:36,630] {processor.py:163} INFO - Started process (PID=61375) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:02:36,630] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:02:36,630] {logging_mixin.py:109} INFO - [2022-03-20 12:02:36,630] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:02:40,168] {logging_mixin.py:109} INFO - [2022-03-20 12:02:40,166] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:02:40,191] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:02:40,196] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.567 seconds
[2022-03-20 12:03:56,799] {processor.py:163} INFO - Started process (PID=61446) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:03:56,799] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:03:56,799] {logging_mixin.py:109} INFO - [2022-03-20 12:03:56,799] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:04:00,629] {logging_mixin.py:109} INFO - [2022-03-20 12:04:00,627] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:04:00,651] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:04:00,655] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.857 seconds
[2022-03-20 12:05:17,235] {processor.py:163} INFO - Started process (PID=61507) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:05:17,235] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:05:17,235] {logging_mixin.py:109} INFO - [2022-03-20 12:05:17,235] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:05:21,313] {logging_mixin.py:109} INFO - [2022-03-20 12:05:21,310] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:05:21,334] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:05:21,338] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.104 seconds
[2022-03-20 12:06:37,949] {processor.py:163} INFO - Started process (PID=61614) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:06:37,951] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:06:37,952] {logging_mixin.py:109} INFO - [2022-03-20 12:06:37,951] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:06:41,864] {logging_mixin.py:109} INFO - [2022-03-20 12:06:41,862] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:06:41,886] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:06:41,890] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.942 seconds
[2022-03-20 12:07:54,194] {processor.py:163} INFO - Started process (PID=61670) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:07:54,194] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:07:54,195] {logging_mixin.py:109} INFO - [2022-03-20 12:07:54,195] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:07:57,787] {logging_mixin.py:109} INFO - [2022-03-20 12:07:57,785] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:07:57,810] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:07:57,815] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.622 seconds
[2022-03-20 12:09:14,420] {processor.py:163} INFO - Started process (PID=61734) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:09:14,420] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:09:14,421] {logging_mixin.py:109} INFO - [2022-03-20 12:09:14,420] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:09:18,540] {logging_mixin.py:109} INFO - [2022-03-20 12:09:18,537] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:09:18,564] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:09:18,571] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.152 seconds
[2022-03-20 12:10:34,820] {processor.py:163} INFO - Started process (PID=61794) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:10:34,820] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:10:34,820] {logging_mixin.py:109} INFO - [2022-03-20 12:10:34,820] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:10:38,423] {logging_mixin.py:109} INFO - [2022-03-20 12:10:38,421] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:10:38,445] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:10:38,451] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.632 seconds
[2022-03-20 12:11:54,997] {processor.py:163} INFO - Started process (PID=61852) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:11:54,997] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:11:54,998] {logging_mixin.py:109} INFO - [2022-03-20 12:11:54,998] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:11:58,975] {logging_mixin.py:109} INFO - [2022-03-20 12:11:58,973] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:11:58,997] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:11:59,002] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.005 seconds
[2022-03-20 12:13:14,925] {processor.py:163} INFO - Started process (PID=61912) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:13:14,925] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:13:14,926] {logging_mixin.py:109} INFO - [2022-03-20 12:13:14,926] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:13:18,755] {logging_mixin.py:109} INFO - [2022-03-20 12:13:18,753] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:13:18,776] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:13:18,781] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.857 seconds
[2022-03-20 12:14:35,337] {processor.py:163} INFO - Started process (PID=61972) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:14:35,337] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:14:35,338] {logging_mixin.py:109} INFO - [2022-03-20 12:14:35,338] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:14:39,649] {logging_mixin.py:109} INFO - [2022-03-20 12:14:39,647] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:14:39,672] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:14:39,677] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.341 seconds
[2022-03-20 12:15:55,771] {processor.py:163} INFO - Started process (PID=62035) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:15:55,771] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:15:55,772] {logging_mixin.py:109} INFO - [2022-03-20 12:15:55,772] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:15:59,273] {logging_mixin.py:109} INFO - [2022-03-20 12:15:59,271] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:15:59,296] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:15:59,302] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.531 seconds
[2022-03-20 12:17:15,983] {processor.py:163} INFO - Started process (PID=62098) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:17:15,983] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:17:15,984] {logging_mixin.py:109} INFO - [2022-03-20 12:17:15,983] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:17:19,883] {logging_mixin.py:109} INFO - [2022-03-20 12:17:19,881] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:17:19,905] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:17:19,911] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.928 seconds
[2022-03-20 12:18:36,333] {processor.py:163} INFO - Started process (PID=62160) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:18:36,334] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:18:36,334] {logging_mixin.py:109} INFO - [2022-03-20 12:18:36,334] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:18:40,018] {logging_mixin.py:109} INFO - [2022-03-20 12:18:40,016] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:18:40,039] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:18:40,044] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.711 seconds
[2022-03-20 12:19:56,680] {processor.py:163} INFO - Started process (PID=62217) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:19:56,680] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:19:56,680] {logging_mixin.py:109} INFO - [2022-03-20 12:19:56,680] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:20:00,753] {logging_mixin.py:109} INFO - [2022-03-20 12:20:00,750] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:20:00,775] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:20:00,780] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.101 seconds
[2022-03-20 12:21:17,114] {processor.py:163} INFO - Started process (PID=62279) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:21:17,115] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:21:17,115] {logging_mixin.py:109} INFO - [2022-03-20 12:21:17,115] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:21:20,734] {logging_mixin.py:109} INFO - [2022-03-20 12:21:20,732] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:21:20,757] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:21:20,762] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.648 seconds
[2022-03-20 12:22:37,387] {processor.py:163} INFO - Started process (PID=62337) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:22:37,387] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:22:37,387] {logging_mixin.py:109} INFO - [2022-03-20 12:22:37,387] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:22:41,331] {logging_mixin.py:109} INFO - [2022-03-20 12:22:41,329] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:22:41,352] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:22:41,358] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.972 seconds
[2022-03-20 12:23:57,777] {processor.py:163} INFO - Started process (PID=62398) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:23:57,778] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:23:57,778] {logging_mixin.py:109} INFO - [2022-03-20 12:23:57,778] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:24:01,652] {logging_mixin.py:109} INFO - [2022-03-20 12:24:01,650] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:24:01,674] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:24:01,679] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.903 seconds
[2022-03-20 12:25:18,379] {processor.py:163} INFO - Started process (PID=62462) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:25:18,379] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:25:18,380] {logging_mixin.py:109} INFO - [2022-03-20 12:25:18,380] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:25:22,335] {logging_mixin.py:109} INFO - [2022-03-20 12:25:22,332] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:25:22,356] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:25:22,361] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.982 seconds
[2022-03-20 12:26:38,672] {processor.py:163} INFO - Started process (PID=62568) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:26:38,673] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:26:38,673] {logging_mixin.py:109} INFO - [2022-03-20 12:26:38,673] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:26:42,371] {logging_mixin.py:109} INFO - [2022-03-20 12:26:42,369] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:26:42,393] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:26:42,398] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.727 seconds
[2022-03-20 12:27:58,749] {processor.py:163} INFO - Started process (PID=62626) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:27:58,749] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:27:58,750] {logging_mixin.py:109} INFO - [2022-03-20 12:27:58,750] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:28:02,841] {logging_mixin.py:109} INFO - [2022-03-20 12:28:02,839] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:28:02,863] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:28:02,868] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.120 seconds
[2022-03-20 12:29:19,152] {processor.py:163} INFO - Started process (PID=62687) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:29:19,153] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:29:19,153] {logging_mixin.py:109} INFO - [2022-03-20 12:29:19,153] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:29:22,999] {logging_mixin.py:109} INFO - [2022-03-20 12:29:22,997] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:29:23,021] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:29:23,027] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.875 seconds
[2022-03-20 12:30:39,587] {processor.py:163} INFO - Started process (PID=62747) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:30:39,587] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:30:39,588] {logging_mixin.py:109} INFO - [2022-03-20 12:30:39,588] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:30:43,626] {logging_mixin.py:109} INFO - [2022-03-20 12:30:43,623] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:30:43,649] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:30:43,655] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.068 seconds
[2022-03-20 12:32:00,007] {processor.py:163} INFO - Started process (PID=62804) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:32:00,008] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:32:00,008] {logging_mixin.py:109} INFO - [2022-03-20 12:32:00,008] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:32:03,663] {logging_mixin.py:109} INFO - [2022-03-20 12:32:03,661] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:32:03,687] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:32:03,692] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.685 seconds
[2022-03-20 12:33:20,386] {processor.py:163} INFO - Started process (PID=62859) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:33:20,386] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:33:20,387] {logging_mixin.py:109} INFO - [2022-03-20 12:33:20,386] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:33:24,340] {logging_mixin.py:109} INFO - [2022-03-20 12:33:24,338] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:33:24,362] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:33:24,367] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.982 seconds
[2022-03-20 12:34:40,948] {processor.py:163} INFO - Started process (PID=62923) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:34:40,950] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:34:40,950] {logging_mixin.py:109} INFO - [2022-03-20 12:34:40,950] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:34:44,991] {logging_mixin.py:109} INFO - [2022-03-20 12:34:44,989] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:34:45,013] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:34:45,017] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.069 seconds
[2022-03-20 12:36:01,231] {processor.py:163} INFO - Started process (PID=62987) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:36:01,231] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:36:01,232] {logging_mixin.py:109} INFO - [2022-03-20 12:36:01,232] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:36:05,080] {logging_mixin.py:109} INFO - [2022-03-20 12:36:05,078] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:36:05,101] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:36:05,105] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.875 seconds
[2022-03-20 12:37:21,739] {processor.py:163} INFO - Started process (PID=63045) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:37:21,739] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:37:21,740] {logging_mixin.py:109} INFO - [2022-03-20 12:37:21,740] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:37:25,651] {logging_mixin.py:109} INFO - [2022-03-20 12:37:25,649] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:37:25,673] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:37:25,679] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.941 seconds
[2022-03-20 12:38:42,184] {processor.py:163} INFO - Started process (PID=63105) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:38:42,184] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:38:42,184] {logging_mixin.py:109} INFO - [2022-03-20 12:38:42,184] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:38:45,988] {logging_mixin.py:109} INFO - [2022-03-20 12:38:45,986] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:38:46,009] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:38:46,014] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.831 seconds
[2022-03-20 12:40:02,519] {processor.py:163} INFO - Started process (PID=63172) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:40:02,520] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:40:02,520] {logging_mixin.py:109} INFO - [2022-03-20 12:40:02,520] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:40:06,537] {logging_mixin.py:109} INFO - [2022-03-20 12:40:06,535] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:40:06,559] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:40:06,563] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.044 seconds
[2022-03-20 12:41:22,904] {processor.py:163} INFO - Started process (PID=63228) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:41:22,904] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:41:22,904] {logging_mixin.py:109} INFO - [2022-03-20 12:41:22,904] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:41:26,623] {logging_mixin.py:109} INFO - [2022-03-20 12:41:26,621] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:41:26,645] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:41:26,650] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.747 seconds
[2022-03-20 12:42:43,238] {processor.py:163} INFO - Started process (PID=63287) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:42:43,238] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:42:43,238] {logging_mixin.py:109} INFO - [2022-03-20 12:42:43,238] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:42:46,672] {logging_mixin.py:109} INFO - [2022-03-20 12:42:46,670] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:42:46,695] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:42:46,700] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.463 seconds
[2022-03-20 12:44:03,364] {processor.py:163} INFO - Started process (PID=63347) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:44:03,364] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:44:03,364] {logging_mixin.py:109} INFO - [2022-03-20 12:44:03,364] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:44:07,288] {logging_mixin.py:109} INFO - [2022-03-20 12:44:07,286] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:44:07,310] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:44:07,315] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.952 seconds
[2022-03-20 12:45:23,731] {processor.py:163} INFO - Started process (PID=63407) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:45:23,732] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:45:23,732] {logging_mixin.py:109} INFO - [2022-03-20 12:45:23,732] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:45:27,545] {logging_mixin.py:109} INFO - [2022-03-20 12:45:27,543] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:45:27,567] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:45:27,572] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.842 seconds
[2022-03-20 12:46:44,230] {processor.py:163} INFO - Started process (PID=63512) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:46:44,230] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:46:44,230] {logging_mixin.py:109} INFO - [2022-03-20 12:46:44,230] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:46:47,936] {logging_mixin.py:109} INFO - [2022-03-20 12:46:47,934] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:46:47,957] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:46:47,963] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.734 seconds
[2022-03-20 12:48:04,399] {processor.py:163} INFO - Started process (PID=63572) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:48:04,400] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:48:04,400] {logging_mixin.py:109} INFO - [2022-03-20 12:48:04,400] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:48:07,837] {logging_mixin.py:109} INFO - [2022-03-20 12:48:07,835] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:48:07,859] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:48:07,864] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.465 seconds
[2022-03-20 12:49:24,418] {processor.py:163} INFO - Started process (PID=63633) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:49:24,418] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:49:24,418] {logging_mixin.py:109} INFO - [2022-03-20 12:49:24,418] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:49:28,518] {logging_mixin.py:109} INFO - [2022-03-20 12:49:28,516] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:49:28,539] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:49:28,546] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.129 seconds
[2022-03-20 12:50:45,005] {processor.py:163} INFO - Started process (PID=63694) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:50:45,007] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:50:45,008] {logging_mixin.py:109} INFO - [2022-03-20 12:50:45,008] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:50:49,020] {logging_mixin.py:109} INFO - [2022-03-20 12:50:49,018] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:50:49,043] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:50:49,049] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.044 seconds
[2022-03-20 12:52:05,334] {processor.py:163} INFO - Started process (PID=63759) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:52:05,335] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:52:05,335] {logging_mixin.py:109} INFO - [2022-03-20 12:52:05,335] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:52:09,026] {logging_mixin.py:109} INFO - [2022-03-20 12:52:09,024] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:52:09,048] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:52:09,054] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.720 seconds
[2022-03-20 12:53:25,593] {processor.py:163} INFO - Started process (PID=63818) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:53:25,593] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:53:25,593] {logging_mixin.py:109} INFO - [2022-03-20 12:53:25,593] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:53:29,049] {logging_mixin.py:109} INFO - [2022-03-20 12:53:29,047] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:53:29,071] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:53:29,076] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.485 seconds
[2022-03-20 12:54:45,825] {processor.py:163} INFO - Started process (PID=63886) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:54:45,826] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:54:45,826] {logging_mixin.py:109} INFO - [2022-03-20 12:54:45,826] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:54:49,844] {logging_mixin.py:109} INFO - [2022-03-20 12:54:49,842] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:54:49,866] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:54:49,870] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.046 seconds
[2022-03-20 12:56:06,216] {processor.py:163} INFO - Started process (PID=63945) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:56:06,216] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:56:06,217] {logging_mixin.py:109} INFO - [2022-03-20 12:56:06,217] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:56:09,813] {logging_mixin.py:109} INFO - [2022-03-20 12:56:09,811] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:56:09,836] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:56:09,841] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.625 seconds
[2022-03-20 12:57:26,390] {processor.py:163} INFO - Started process (PID=64004) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:57:26,391] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:57:26,391] {logging_mixin.py:109} INFO - [2022-03-20 12:57:26,391] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:57:30,083] {logging_mixin.py:109} INFO - [2022-03-20 12:57:30,081] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:57:30,105] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:57:30,110] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.721 seconds
[2022-03-20 12:58:46,723] {processor.py:163} INFO - Started process (PID=64064) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:58:46,723] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 12:58:46,723] {logging_mixin.py:109} INFO - [2022-03-20 12:58:46,723] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:58:50,231] {logging_mixin.py:109} INFO - [2022-03-20 12:58:50,229] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 12:58:50,253] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 12:58:50,258] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.536 seconds
[2022-03-20 13:00:07,031] {processor.py:163} INFO - Started process (PID=64129) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 13:00:07,031] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 13:00:07,032] {logging_mixin.py:109} INFO - [2022-03-20 13:00:07,032] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 13:00:11,227] {logging_mixin.py:109} INFO - [2022-03-20 13:00:11,225] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 13:00:11,248] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 13:00:11,255] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.225 seconds
[2022-03-20 13:01:27,341] {processor.py:163} INFO - Started process (PID=64188) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 13:01:27,342] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 13:01:27,342] {logging_mixin.py:109} INFO - [2022-03-20 13:01:27,342] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 13:01:30,786] {logging_mixin.py:109} INFO - [2022-03-20 13:01:30,784] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 13:01:30,809] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 13:01:30,814] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.473 seconds
[2022-03-20 13:02:47,297] {processor.py:163} INFO - Started process (PID=64245) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 13:02:47,298] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 13:02:47,299] {logging_mixin.py:109} INFO - [2022-03-20 13:02:47,299] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 13:02:50,943] {logging_mixin.py:109} INFO - [2022-03-20 13:02:50,940] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 13:02:50,965] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 13:02:50,970] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.673 seconds
[2022-03-20 13:04:07,537] {processor.py:163} INFO - Started process (PID=64304) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 13:04:07,538] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 13:04:07,538] {logging_mixin.py:109} INFO - [2022-03-20 13:04:07,538] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 13:04:11,195] {logging_mixin.py:109} INFO - [2022-03-20 13:04:11,193] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 13:04:11,218] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 13:04:11,223] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.686 seconds
[2022-03-20 13:05:27,794] {processor.py:163} INFO - Started process (PID=64367) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 13:05:27,794] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 13:05:27,794] {logging_mixin.py:109} INFO - [2022-03-20 13:05:27,794] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 13:05:31,878] {logging_mixin.py:109} INFO - [2022-03-20 13:05:31,876] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 13:05:31,900] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 13:05:31,905] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.112 seconds
[2022-03-20 13:06:48,245] {processor.py:163} INFO - Started process (PID=64470) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 13:06:48,246] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 13:06:48,246] {logging_mixin.py:109} INFO - [2022-03-20 13:06:48,246] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 13:06:51,682] {logging_mixin.py:109} INFO - [2022-03-20 13:06:51,680] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 13:06:51,703] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 13:06:51,709] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.464 seconds
[2022-03-20 13:08:08,385] {processor.py:163} INFO - Started process (PID=64528) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 13:08:08,386] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-20 13:08:08,386] {logging_mixin.py:109} INFO - [2022-03-20 13:08:08,386] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 13:08:12,371] {logging_mixin.py:109} INFO - [2022-03-20 13:08:12,369] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-20 13:08:12,393] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-20 13:08:12,398] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.013 seconds
