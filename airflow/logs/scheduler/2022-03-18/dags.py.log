[2022-03-18 10:37:42,210] {processor.py:163} INFO - Started process (PID=46436) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 10:37:42,210] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-18 10:37:42,210] {logging_mixin.py:109} INFO - [2022-03-18 10:37:42,210] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 10:37:47,833] {logging_mixin.py:109} INFO - [2022-03-18 10:37:47,826] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-18 10:37:47,855] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 10:37:47,860] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 5.651 seconds
[2022-03-18 10:39:08,736] {processor.py:163} INFO - Started process (PID=46505) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 10:39:08,736] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-18 10:39:08,736] {logging_mixin.py:109} INFO - [2022-03-18 10:39:08,736] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 10:39:12,978] {logging_mixin.py:109} INFO - [2022-03-18 10:39:12,976] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-18 10:39:13,001] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 10:39:13,006] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.271 seconds
[2022-03-18 17:05:56,814] {processor.py:163} INFO - Started process (PID=46703) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:05:56,816] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-18 17:05:56,817] {logging_mixin.py:109} INFO - [2022-03-18 17:05:56,817] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:06:02,644] {logging_mixin.py:109} INFO - [2022-03-18 17:06:02,636] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-18 17:06:02,666] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:06:02,670] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 5.855 seconds
[2022-03-18 17:07:28,688] {processor.py:163} INFO - Started process (PID=46785) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:07:28,688] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-18 17:07:28,689] {logging_mixin.py:109} INFO - [2022-03-18 17:07:28,689] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:07:32,764] {logging_mixin.py:109} INFO - [2022-03-18 17:07:32,761] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-18 17:07:32,795] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:07:32,800] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.113 seconds
[2022-03-18 17:08:57,305] {processor.py:163} INFO - Started process (PID=46862) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:08:57,305] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-18 17:08:57,305] {logging_mixin.py:109} INFO - [2022-03-18 17:08:57,305] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:09:01,715] {logging_mixin.py:109} INFO - [2022-03-18 17:09:01,711] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-18 17:09:01,738] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:09:01,743] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.439 seconds
[2022-03-18 17:10:21,177] {processor.py:163} INFO - Started process (PID=46932) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:10:21,178] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-18 17:10:21,178] {logging_mixin.py:109} INFO - [2022-03-18 17:10:21,178] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:10:26,733] {logging_mixin.py:109} INFO - [2022-03-18 17:10:26,727] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-18 17:10:26,759] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:10:26,766] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 5.590 seconds
[2022-03-18 17:11:59,555] {processor.py:163} INFO - Started process (PID=47008) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:11:59,556] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-18 17:11:59,556] {logging_mixin.py:109} INFO - [2022-03-18 17:11:59,556] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:12:05,505] {logging_mixin.py:109} INFO - [2022-03-18 17:12:05,498] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-18 17:12:05,527] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:12:05,533] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 5.979 seconds
[2022-03-18 17:13:24,117] {processor.py:163} INFO - Started process (PID=47076) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:13:24,118] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-18 17:13:24,119] {logging_mixin.py:109} INFO - [2022-03-18 17:13:24,119] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:13:29,388] {logging_mixin.py:109} INFO - [2022-03-18 17:13:29,382] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-18 17:13:29,414] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:13:29,420] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 5.303 seconds
[2022-03-18 17:14:48,789] {processor.py:163} INFO - Started process (PID=47136) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:14:48,790] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-18 17:14:48,790] {logging_mixin.py:109} INFO - [2022-03-18 17:14:48,790] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:14:54,299] {logging_mixin.py:109} INFO - [2022-03-18 17:14:54,293] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-18 17:14:54,327] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:14:54,333] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 5.545 seconds
[2022-03-18 17:16:14,103] {processor.py:163} INFO - Started process (PID=47203) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:16:14,105] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-18 17:16:14,105] {logging_mixin.py:109} INFO - [2022-03-18 17:16:14,105] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:16:19,169] {logging_mixin.py:109} INFO - [2022-03-18 17:16:19,164] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-18 17:16:19,193] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:16:19,198] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 5.096 seconds
[2022-03-18 17:17:38,829] {processor.py:163} INFO - Started process (PID=47277) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:17:38,830] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-18 17:17:38,831] {logging_mixin.py:109} INFO - [2022-03-18 17:17:38,830] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:17:43,929] {logging_mixin.py:109} INFO - [2022-03-18 17:17:43,923] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-18 17:17:43,952] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:17:43,956] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 5.128 seconds
[2022-03-18 17:19:03,112] {processor.py:163} INFO - Started process (PID=47341) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:19:03,112] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-18 17:19:03,112] {logging_mixin.py:109} INFO - [2022-03-18 17:19:03,112] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:19:07,677] {logging_mixin.py:109} INFO - [2022-03-18 17:19:07,672] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-18 17:19:07,700] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:19:07,705] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.594 seconds
[2022-03-18 17:24:44,146] {processor.py:163} INFO - Started process (PID=47565) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:24:44,147] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-18 17:24:44,147] {logging_mixin.py:109} INFO - [2022-03-18 17:24:44,147] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:24:50,834] {logging_mixin.py:109} INFO - [2022-03-18 17:24:50,825] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-18 17:24:50,863] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:24:50,869] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 6.723 seconds
[2022-03-18 17:26:19,254] {processor.py:163} INFO - Started process (PID=47650) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:26:19,254] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-18 17:26:19,255] {logging_mixin.py:109} INFO - [2022-03-18 17:26:19,255] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:26:24,566] {logging_mixin.py:109} INFO - [2022-03-18 17:26:24,558] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-18 17:26:24,588] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:26:24,592] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 5.339 seconds
[2022-03-18 17:29:11,433] {processor.py:163} INFO - Started process (PID=47774) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:29:11,433] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-18 17:29:11,434] {logging_mixin.py:109} INFO - [2022-03-18 17:29:11,434] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:29:16,993] {logging_mixin.py:109} INFO - [2022-03-18 17:29:16,985] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-18 17:29:17,016] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:29:17,021] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 5.589 seconds
[2022-03-18 17:32:29,509] {processor.py:163} INFO - Started process (PID=47946) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:32:29,509] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-18 17:32:29,509] {logging_mixin.py:109} INFO - [2022-03-18 17:32:29,509] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:32:34,902] {logging_mixin.py:109} INFO - [2022-03-18 17:32:34,895] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-18 17:32:34,923] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:32:34,928] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 5.420 seconds
[2022-03-18 17:33:54,882] {processor.py:163} INFO - Started process (PID=48410) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:33:54,883] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-18 17:33:54,883] {logging_mixin.py:109} INFO - [2022-03-18 17:33:54,883] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:33:58,512] {logging_mixin.py:109} INFO - [2022-03-18 17:33:58,510] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-18 17:33:58,535] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:33:58,540] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.659 seconds
[2022-03-18 17:35:16,674] {processor.py:163} INFO - Started process (PID=48495) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:35:16,674] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-18 17:35:16,675] {logging_mixin.py:109} INFO - [2022-03-18 17:35:16,675] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:35:21,033] {logging_mixin.py:109} INFO - [2022-03-18 17:35:21,031] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-18 17:35:21,055] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:35:21,060] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.386 seconds
[2022-03-18 17:36:39,374] {processor.py:163} INFO - Started process (PID=48577) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:36:39,374] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-18 17:36:39,374] {logging_mixin.py:109} INFO - [2022-03-18 17:36:39,374] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:36:43,876] {logging_mixin.py:109} INFO - [2022-03-18 17:36:43,874] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-18 17:36:43,900] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:36:43,907] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.534 seconds
[2022-03-18 17:38:03,434] {processor.py:163} INFO - Started process (PID=48646) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:38:03,435] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-18 17:38:03,435] {logging_mixin.py:109} INFO - [2022-03-18 17:38:03,435] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:38:07,656] {logging_mixin.py:109} INFO - [2022-03-18 17:38:07,654] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-18 17:38:07,680] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:38:07,685] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.252 seconds
[2022-03-18 17:39:28,212] {processor.py:163} INFO - Started process (PID=48723) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:39:28,212] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-18 17:39:28,213] {logging_mixin.py:109} INFO - [2022-03-18 17:39:28,213] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:39:34,059] {logging_mixin.py:109} INFO - [2022-03-18 17:39:34,050] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-18 17:39:34,081] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:39:34,086] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 5.875 seconds
[2022-03-18 17:40:53,935] {processor.py:163} INFO - Started process (PID=48817) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:40:53,935] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-18 17:40:53,935] {logging_mixin.py:109} INFO - [2022-03-18 17:40:53,935] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:40:57,997] {logging_mixin.py:109} INFO - [2022-03-18 17:40:57,994] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-18 17:40:58,018] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:40:58,024] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.090 seconds
[2022-03-18 17:42:15,815] {processor.py:163} INFO - Started process (PID=48897) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:42:15,816] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-18 17:42:15,816] {logging_mixin.py:109} INFO - [2022-03-18 17:42:15,816] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:42:20,150] {logging_mixin.py:109} INFO - [2022-03-18 17:42:20,148] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-18 17:42:20,171] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:42:20,176] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.361 seconds
[2022-03-18 17:43:39,360] {processor.py:163} INFO - Started process (PID=48959) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:43:39,361] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-18 17:43:39,361] {logging_mixin.py:109} INFO - [2022-03-18 17:43:39,361] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:43:43,181] {logging_mixin.py:109} INFO - [2022-03-18 17:43:43,179] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-18 17:43:43,205] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:43:43,210] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 3.851 seconds
[2022-03-18 17:45:01,912] {processor.py:163} INFO - Started process (PID=49020) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:45:01,913] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-18 17:45:01,913] {logging_mixin.py:109} INFO - [2022-03-18 17:45:01,913] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:45:06,494] {logging_mixin.py:109} INFO - [2022-03-18 17:45:06,491] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-18 17:45:06,519] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:45:06,526] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.614 seconds
[2022-03-18 17:46:25,985] {processor.py:163} INFO - Started process (PID=49091) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:46:25,985] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-18 17:46:25,985] {logging_mixin.py:109} INFO - [2022-03-18 17:46:25,985] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:46:30,503] {logging_mixin.py:109} INFO - [2022-03-18 17:46:30,499] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-18 17:46:30,537] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:46:30,544] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.560 seconds
[2022-03-18 17:47:50,225] {processor.py:163} INFO - Started process (PID=49162) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:47:50,226] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-18 17:47:50,226] {logging_mixin.py:109} INFO - [2022-03-18 17:47:50,226] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:47:54,528] {logging_mixin.py:109} INFO - [2022-03-18 17:47:54,525] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-18 17:47:54,553] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:47:54,558] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.334 seconds
[2022-03-18 17:49:14,970] {processor.py:163} INFO - Started process (PID=50912) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:49:14,971] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-18 17:49:14,972] {logging_mixin.py:109} INFO - [2022-03-18 17:49:14,972] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:49:19,571] {logging_mixin.py:109} INFO - [2022-03-18 17:49:19,568] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-18 17:49:19,596] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:49:19,603] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.634 seconds
[2022-03-18 17:50:38,629] {processor.py:163} INFO - Started process (PID=50979) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:50:38,630] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-18 17:50:38,630] {logging_mixin.py:109} INFO - [2022-03-18 17:50:38,630] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:50:43,076] {logging_mixin.py:109} INFO - [2022-03-18 17:50:43,073] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-18 17:50:43,101] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:50:43,107] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.478 seconds
[2022-03-18 17:52:04,128] {processor.py:163} INFO - Started process (PID=51062) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:52:04,133] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-18 17:52:04,134] {logging_mixin.py:109} INFO - [2022-03-18 17:52:04,133] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:52:08,704] {logging_mixin.py:109} INFO - [2022-03-18 17:52:08,702] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-18 17:52:08,730] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:52:08,737] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.609 seconds
[2022-03-18 17:53:27,248] {processor.py:163} INFO - Started process (PID=51129) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:53:27,248] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-18 17:53:27,249] {logging_mixin.py:109} INFO - [2022-03-18 17:53:27,249] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:53:31,729] {logging_mixin.py:109} INFO - [2022-03-18 17:53:31,726] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-18 17:53:31,753] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:53:31,758] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.511 seconds
[2022-03-18 17:54:49,491] {processor.py:163} INFO - Started process (PID=51198) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:54:49,492] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-18 17:54:49,493] {logging_mixin.py:109} INFO - [2022-03-18 17:54:49,492] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:54:54,019] {logging_mixin.py:109} INFO - [2022-03-18 17:54:54,017] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-18 17:54:54,046] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:54:54,051] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.560 seconds
[2022-03-18 17:56:13,570] {processor.py:163} INFO - Started process (PID=51264) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:56:13,571] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-18 17:56:13,572] {logging_mixin.py:109} INFO - [2022-03-18 17:56:13,572] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:56:18,180] {logging_mixin.py:109} INFO - [2022-03-18 17:56:18,174] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-18 17:56:18,206] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:56:18,212] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 4.642 seconds
[2022-03-18 17:57:38,602] {processor.py:163} INFO - Started process (PID=51328) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:57:38,604] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-18 17:57:38,604] {logging_mixin.py:109} INFO - [2022-03-18 17:57:38,604] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:57:44,678] {logging_mixin.py:109} INFO - [2022-03-18 17:57:44,668] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-18 17:57:44,726] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:57:44,736] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 6.134 seconds
[2022-03-18 17:59:12,306] {processor.py:163} INFO - Started process (PID=51491) to work on /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:59:12,307] {processor.py:642} INFO - Processing file /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py for tasks to queue
[2022-03-18 17:59:12,307] {logging_mixin.py:109} INFO - [2022-03-18 17:59:12,307] {dagbag.py:500} INFO - Filling up the DagBag from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:59:17,915] {logging_mixin.py:109} INFO - [2022-03-18 17:59:17,908] {dagbag.py:334} ERROR - Failed to import: /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
Traceback (most recent call last):
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 36, in <module>
    etl()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py", line 9, in etl
    movies_df = extract_movies_to_df()
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/transformation.py", line 13, in extract_movies_to_df
    movies_df = spark.read \
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/readwriter.py", line 164, in load
    return self._df(self._jreader.load())
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow_env/lib/python3.9/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o36.load.
: org.postgresql.util.PSQLException: Connection to localhost:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:319)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:223)
	at org.postgresql.Driver.makeConnection(Driver.java:400)
	at org.postgresql.Driver.connect(Driver.java:259)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)
	at org.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:77)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:64)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.getQueryOutputSchema(JDBCRDD.scala:62)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRDD$.resolveTable(JDBCRDD.scala:57)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCRelation$.getSchema(JDBCRelation.scala:239)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:36)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:174)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:830)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:579)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:542)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:597)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:339)
	at java.base/java.net.Socket.connect(Socket.java:603)
	at org.postgresql.core.PGStream.createSocket(PGStream.java:241)
	at org.postgresql.core.PGStream.<init>(PGStream.java:98)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:109)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:235)
	... 29 more
[2022-03-18 17:59:17,940] {processor.py:656} WARNING - No viable dags retrieved from /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py
[2022-03-18 17:59:17,945] {processor.py:171} INFO - Processing /Users/louisekirkham/Documents/linkedin_learning/Ex_Files_Data_Engineering_Foundations/airflow/dags/dags.py took 5.640 seconds
